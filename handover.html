<!DOCTYPE html>
<html lang="tw">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <meta name="description" content="">
    <meta name="author" content="">

    <title>悅盛保全 - 櫃台服務系統</title>

    <!-- Bootstrap core CSS -->
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">

    <!-- Optional theme -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap-theme.min.css" integrity="sha384-fLW2N01lMqjakBkx3l/M9EahuwpSfeNvV63J5ezn3uZzapT0u7EYsXMjQV+0En5r" crossorigin="anonymous">
    
    <script src="/js/jquery.js"></script>
    <!-- Latest compiled and minified JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>
    
    <link rel="stylesheet" href="/css/main.css">
    <script type="text/javascript" src="/js/Common.js"></script>
    <script src="/js/vue.js" ></script>    
    <style type="text/css">
      textarea {
        resize: none;
        overflow: hidden;
        min-height: 50px;
        max-height: 100px;
      }
      input[readonly],textarea[readonly] {
        color: #1121dc;
      }
      .editMode{
        float:right !important;
      }
      .pointer{
        cursor:pointer;
      }
    </style>
  </head>
  <body> 
    <div class="loadingMask" style="width:100%;height:100%;position:fixed;background: rgba(0,0,0,0.3);z-index:1111;display: none"></div>
    <header>
      <nav class="navbar">
      </nav>
    </header>
    <!-- Main jumbotron for a primary marketing message or call to action -->
    <div class="jumbotron">
      <div class="container">
        <form name="sopForm" method="POST" action="">
          <input type="hidden" name="action" value="addWorkRecord">
          <input type="hidden" name="F_EMP_ID" value="">
          <input type="hidden" name="F_POINT_ID" value="">
          <div class="panel panel-warning" id="pointPanel"> 
            <div class="panel-heading"> 
              <h3 class="panel-title" style="float:left">
                <select style="margin-right:10px;padding:3px;" v-model="currentDate" @change="dateChage">
                  <option :value="v" v-for="(v,k) in dateOptions">{{v}}</option>
                </select>
                {{currentEmpName}}-現場工作紀錄
              </h3> 
              <ul class="nav nav-tabs">
                <li class="active pointer editMode">
                  <a class="pointTab pointer" :class="{'alert-info': editMode=='a'}" @click="changeMode('a')">
                    標準值勤
                  </a>
                </li>
                <li class="active pointer editMode" >
                  <a class="pointTab pointer":class="{'alert-info': editMode=='b'}" @click="changeMode('b')">
                    其他項目
                  </a>
                </li>
              </ul>
            </div> 
            <div class="panel-body ">
              <div class="text-danger">注意事項</div>
              <textarea class="form-control" @blur="savePrecautions" v-model="precautions"></textarea  >
              <hr>
              <div id="pointTabs" v-show="editMode=='a'">
                <ul class="nav nav-tabs">
                    <li role="presentation" :class="{ active: k==currentTabKey }" v-for="(v,k) in tabs">
                      <a class="pointTab pointer" @click="clickTab(k,v.F_POINT_ID)">
                        {{v.F_POINT_NAME}}({{v.F_EMP_NAME}})
                      </a>
                    </li>
                  </ul>
              </div>
              <div class="pointSop" v-show="editMode=='a'">
                <table class="table table-bordered todoTable">
                  <thead>
                    <tr>
                      <th colspan="4">
                        {{sopData.typeName}}
                        <button @click="saveWork" type="button" class="btn alert-secondary text-warning" style="float:right">存檔</button>
                      </th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <th width="80">
                        狀態
                      </th>
                      <th width="170">
                        時間
                      </th>
                      <th>
                        項目名稱
                      </th>
                      <th>
                        備註
                      </th>
                    </tr>
                    <tr v-for="(sopList,slk) in sopData.list">
                      <td :class="{'alert-success': sopList.done}">
                        <span v-show="sopList.done" class="text-danger">已填</span>
                        <span v-show="!sopList.done" class="text-dark">未填</span>
                      </td>
                      <td>
                        <div class="input-group">
                          <input type="text" class="form-control " readonly aria-describedby="sizing-addon2" v-model="sopList.F_OT_TIME">
                        </div>
                      </td>
                      <td>
                        <div class="input-group">
                          <textarea class="form-control" :name="'OT_ATTINFO_'+slk" readonly aria-describedby="sizing-addon2" onkeyup="auto_grow(this)">{{sopList.F_OT_ATTINFO}}</textarea>
                        </div>
                      </td>
                      <td>
                        <div class="input-group">
                          <input type="text" class="form-control" :readonly="sopList.done?true:false" placeholder="需填寫備註才能存檔" v-model="sopList.comment">
                        </div>
                      </td>
                    </tr>
                  </tbody>
                </table>
                
                
              </div>
              <table class="table table-bordered todoTable otherJob"  v-show="editMode=='b'"> 
                <thead>
                  <tr>
                    <th colspan="5">
                      <span> 其它</span>
                      <div style="float: right">
                        <button type="button" @click="addOtherJob" id="addOtherJob">新增</button>
                      </div>
                    </th>
                  </tr>
                  <tr>
                    <th width="100">狀態</th>
                    <th width="200">類型</th>
                    <th width="150">時間</th>
                    <th width="250">內容說明</th>
                    <th>備註</th>
                  </tr>
                  <tr v-for="(rec,recKey) in otherRecord">
                    <td>
                      <span v-show="rec.done" class="text-danger">已存檔</span>
                      <span v-show="!rec.done" class="text-dark">未存檔</span>
                    </td>
                    <td>
                      <select class="form-control" v-model="rec.F_TID" @change="changeOtherType(recKey,rec.F_TID)">
                        <option :value="otherOption.F_TID" v-for="(otherOption,ook) in otherTypes" >{{otherOption.F_TNAME}}
                        </option>
                      </select>
                    </td>
                    <td>
                      <div class="input-group">
                        <select class="form-control" v-model="rec.F_OT_TIME" >
                          <option :value="tv" v-for="(tv,tk) in times">{{tv}}</option>
                        </select>
                      </div>
                    </td>
                    <td>
                      <select :disabled="rec.done"  class="form-control" v-model="rec.F_CID" @change="changeCid(recKey)">
                        <option :value="v.F_CID" v-for="(v,k) in rec.typeList">
                          {{v.F_DESC}}
                        </option>
                      </select>
                    </td>
                    <td>
                      <div class="input-group">
                        <textarea :readonly="rec.done" placeholder="需填寫備註才能存檔" cols="30" rows="1" v-model="rec.comment" class="form-control" style="height: 48px;"></textarea>
                      </div>
                    </td>
                  </tr>
                </thead>
              </table>
            </div>
            <div class="panel-footer">
              <a id="sopSaveButton" @click="saveWork" role="button" class="btn btn-default">儲存» </a>
              <!-- <canvas id="canvas2" width="100" height="100"></canvas> -->
            </div> 
          </div>
        </form>
        <!-- <video id="cameraPreview"></video> -->
        <div id="scanArea">
          <video id="video" width="300"></video>  
          <button type="button" id="scanCancel">取消</button>
          <!-- <div class="scanAreaLeftTop"></div>
          <div class="scanAreaRightTop"></div>
          <div class="scanAreaLeftDown"></div>
          <div class="scanAreaRightDown"></div> -->
          <div class="scanAreaCenter"></div>
        </div>
      </div>
    </div>
    <div class="container">
      <footer>
      </footer>
    </div> <!-- /container -->

    <script type="text/javascript" src="js/handover.js"></script>
    <button class="btn btn-lg btn-warning" id="loading" style="display:none;"><span class="glyphicon glyphicon-refresh glyphicon-refresh-animate"></span>請在20秒內掃描員工識別證</button>
  </body>
</html>
