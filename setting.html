<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="icon" href="../../favicon.ico">

    <title>悅盛保全 - 櫃台服務系統 - 客戶名稱</title>
    <link href="/css/sticky-footer-navbar.css" rel="stylesheet">
    <link rel="stylesheet" href="/css/colorbox.css" />

    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">

    <!-- Optional theme -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap-theme.min.css" integrity="sha384-fLW2N01lMqjakBkx3l/M9EahuwpSfeNvV63J5ezn3uZzapT0u7EYsXMjQV+0En5r" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-1.12.0.min.js"></script>
    <!-- Latest compiled and minified JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>
    <!--<script type="text/javascript" src="/js/jquery.colorbox-min.js"></script>-->
    <script type="text/javascript" src="/js/noty/packaged/jquery.noty.packaged.min.js"></script>
    <style>
      h2{
        font-size: 24px;
      }
    </style>
    <link rel="stylesheet" href="/css/main.css">
    <script type="text/javascript" src="/js/Common.js"></script>
  </head>
  <body>

    <!-- Fixed navbar -->
    <div class="loadingMask" style="width:100%;height:100%;position:fixed;background: rgba(0,0,0,0.3);z-index:1111;display: none"></div>
    <nav class="navbar navbar-default navbar-fixed-top"></nav>

    <!-- Begin page content -->
    <div class="container main">
    	<div class="page-header">
		  	<h1>設定廠商</small></h1>
		</div>
      	<div class="row">
      		<div class="custList">
          	</div>
      	</div>
    </div>

    <footer class="footer">
      <div class="container">
        <p class="text-muted">Place sticky footer content here.</p>
      </div>
    </footer>
    <script type="text/javascript">
      var exec = require('child_process').exec,
          child;
      var http = require('http');
      var listJade = jade.compileFile("views/custList.jade");
      var listHtml;      
      
      $(document).ready(function(){
        var custList = $(".custList");
        //$(".viewDetail").colorbox({inline:true, width:"50%"});
        var scanEmpId = "";
        var chooseCust = "";
        var choosePoint = "";
        
        var options = {
          hostname: '61.220.182.219',
          port: 80,
          path: '/api/cust/0/0/0'
        };
        http.get('http://61.220.182.219/api/cust/0/0/0', (res) => {
        	console.log("http 123");
	        res.resume();
	        custList.empty();
	        res.on('data',(d) =>{
	          var custData = JSON.parse(d);
	          listHtml = listJade({custData: custData,currentCust: currentCust});
	          custList.html(listHtml);
	          $("a[custid='"+currentCust+"']").addClass("current");
	        })
  	    }).on('error', (e) => {
  	        console.log(`Got error: ${e.message}`);
  	    });
        custList.delegate(".list-group-item","click",function(){
          var custid=$(this).attr("custid");
          var f = fs.openSync(custFile , 'w+');
          $("a.current").removeClass("current");
          $(this).addClass("current");
          fs.writeSync(f, custid , 'utf-8');
        });
      });
    </script>
    <button class="btn btn-lg btn-warning" id="loading" style="display:none;"><span class="glyphicon glyphicon-refresh glyphicon-refresh-animate"></span>請在20秒內掃描員工識別證</button>
    <script type="text/javascript" src="/js/main.js"></script>
  </body>
</html>
